<h1>Sklep Internetowy (Vanilla JS + Supabase)</h1>
Prosty sklep internetowy napisany w HTML + CSS + JavaScript (bez frameworków).
Dane produktów, użytkowników i koszyka przechowywane są w Supabase (PostgreSQL + REST API).

Projekt działa całkowicie po stronie przeglądarki.

<h2>Funkcjonalności</h2>
<ul>
	<li>Wyświetlanie listy produktów z bazy danych</li>
	<li>Filtroawanie po nazwie kategorii</li>
	<li>Logowanie użytkownika (własna implementacja, bez Supabase Auth)</li>
	<li>Edycja nazwy użytkownika i hasła</li>
	<li>Koszyk zapisany w bazie danych (user_product)</li>
	<li>Dodawanie, usuwanie i zmiana ilości produktów w koszyku</li>
</ul>

<h2>Technologie</h2>
<ul>
	<li>HTML5</li>
	<li>CSS3 (Flexbox)</li>
	<li>Vanilla JavaScript</li>
	<li>Supabase (PostgreSQL + REST API)</li>
</ul>

<h2>Konfiguracja bazy danych (Supabase)</h2>
<ol>
	<h3><li>Utwórz projekt w Supabase</li></h3>
	https://supabase.com/
	<h3><li>Utwórz tabelę products</li></h3>

	create table public.products (
	  id bigint generated by default as identity not null,
	  title text not null,
	  category text not null,
	  price integer not null,
	  image text not null,
	  constraint products_pkey primary key (id),
	  constraint products_id_key unique (id)
	) TABLESPACE pg_default;
	
<h3><li>Utwórz tabelę users</li></h3>

	create table public.users (
	  id bigint generated by default as identity not null,
	  username text not null,
	  password text not null,
	  constraint users_pkey primary key (id),
	  constraint users_id_key unique (id)
	) TABLESPACE pg_default;
<h3><li>Utwórz tabelę user_product</li></h3>

	create table public.user_product (
	  user_id bigint not null,
	  product_id bigint not null,
	  quantity bigint not null default '1'::bigint,
	  constraint user_product_pkey primary key (user_id, product_id),
	  constraint user_product_product_id_fkey foreign KEY (product_id) references products (id) on update CASCADE on delete CASCADE,
	  constraint user_product_user_id_fkey foreign KEY (user_id) references users (id) on update CASCADE on delete CASCADE
	) TABLESPACE pg_default;

<h3><li>Włącz RLS</li></h3>

	alter table products enable row level security;
	alter table users enable row level security;
	alter table user_product enable row level security;

<h3><li>Nadaj prawa roli anon</li></h3>

	grant select on products to anon;
	grant select, update on users to anon;
	grant select, insert, update, delete on user_product to anon;

<h3><li>Dodaj policy</li></h3>

	create policy "Allow anon read products"
	on products for select to anon using (true);
	
	create policy "Allow anon select cart"
	on user_product for select to anon using (true);

	create policy "Allow anon insert cart"
	on user_product for insert to anon with check (true);

	create policy "Allow anon update cart"
	on user_product for update to anon using (true) with check (true);

	create policy "Allow anon delete cart"
	on user_product for delete to anon using (true);
	
	create policy "Allow anon read users"
	on users for select to anon using (true);
	
	create policy "Allow anon update users"
	on users for update to anon using (true) witch check (true);

<h3><li>Dodaj uprawnienia dla anon</li></h3>

	grant usage on schema public to anon;
	grant select on public.products to anon;
	grant select, update on public.users to anon;
	grant select, insert, update, delete on public.users to anon;

<h3><li>Pobierz klucze API i wklej w main.js</li></h3>
Skopiuj:
<ul>
	<li>Project URL</li>
	<li>anon public key</li>
</ul>

Wklej:
 
	const supabase = {
		url: 'Project URL',
		key: 'anon public key'

<h3><li>Komunikacja z bazą</li></h3>
Frontend wykonuje zapytania bezpośrednio do Supabase REST API:

	GET    /rest/v1/products
	POST   /rest/v1/user_product
	PATCH  /rest/v1/users?id=eq.1
	DELETE /rest/v1/user_product

</ol>

